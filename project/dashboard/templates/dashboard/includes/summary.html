{% block content %}
<div class="wrapper" style="padding:20px;" id="admin">
    <div class="row">
        <div class="col-md-12" style="width:40vw;">
        <div class="card">
            <div class="card-body">
            <h5>{{ session['email'] }}</h5>
            {% for user in userInfo %}
              <h1>{{ user.screen_name }}</h1>
            {% endfor %}
            <h1 id="total-followers"></h1>
            <p id="total-post"></p>
            <p id="total-following"></p>
            <div class="container">
                <canvas id="full-followers"></canvas>
                <p>
                
                </p>
            </div>
            <br>
            <br>
            <br>
            <br>
            <br>
            <br>
            </div>
        </div>
        </div>
    </div>

    <!-- Place for javascript divs -->
    <div class="container" id="accounts-tools" style="padding-left:0px; width:40vw">
        <div class="card">
          <a href="#" style="color:#000" id="account-title"><h5>Accounts</h5></a>
          <div class="dashboard-row" id="account-divs"></div>
        </div>
        <div class="dashboard-row" id="connect-account-div"></div>
        <div class="dashboard-row" id="opperations" style="padding-top:10px;"></div>
        <div class="dashboard-row" id="create-opperation-div"></div>
        <div class="dashboard-row" id="search-form-div">
          <!-- <form id="search-form" method="POST">
            <input type="text" id="search-form-text">
            <input type="submit" value="website">
          </form> -->
        </div>

    </div>
</div>
    <!-- Connect Account Modal -->
    <div class="modal fade" id="connect" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Connect Social Media</h5>
                <button type="button" id="hidden-cancel" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
    
            <div class="modal-body">
                <form method="POST" id="posting-form">
                <!-- Connect Accounts -->
                <!-- Ability to select account -->
                <p>
                    Platform:
                    <br>
                    <select id="select-account-type" onchange="optionChange(this)">
                    <option disabled selected value> -- select an option -- </option>
                    <option value="instagram">Instagram</option>
                    <option value="twitter">Twitter</option>
                    </select>
                </p>
            </div>
            </div>
        </div>
    </div>
<!--Disconnect Menu Instagram -->
    <div class="modal fade" id="disconnect-instagram-menu" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true" class="float-right">&times;</span>
            </button>

          <div class="modal-body" id="disconnect-instagram-form">
            <h6>Are You Sure You Want to Disconnect this Account from iBlinkco</h6>
          </div>

          <form method="POST">
            <button id="hidden-cancel-instagram-disconnect" class="" data-dismiss="modal" style="display: none"></button>
            <input type="button" value="Cancel" class="text-success" data-dismiss="modal">
            <input type="button" id="disconnect-button-instagram" name="disconnect-button-instagram" value="Disconnect" class="text-danger">
          </form>
        </div>
      </div>
    </div>

    <!-- Facebook Menu -->
    <div class="modal fade" id="connect-facebook-1" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Connect Facebook</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="modal-body">
            <form action="" method="post">
              <!-- Facebook button connect account -->

              <!-- <button onclick="fb_content_show()" data-dismiss="modal" style="background-color: Transparent; background-repeat:no-repeat; border: none; cursor:pointer; overflow: hidden; outline:none;"> -->
              <fb:login-button id="fb-btn" data-dismiss="modal" scope="public_profile,email,user_birthday,user_location,user_posts" onlogin="checkLoginState();">
              </fb:login-button>
              <!-- </button> -->
            </form>
          </div>
        </div>
      </div>
    </div>

  <!--Disconnect Menu Twitter -->
  <div class="modal fade" id="disconnect-twitter-menu" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="float-right">&times;</span>
          </button>

        <div class="modal-body" id="disconnect-twitter-form">
          <h6>Are You Sure You Want to Disconnect this Account from iBlinkco</h6>
        </div>

        <form method="POST">
          <button id="hidden-cancel-twitter-disconnect" class="" data-dismiss="modal" style="display: none"></button>
          <input type="button" value="Cancel" class="text-success" data-dismiss="modal">
          <input type="button" id="disconnect-button-twitter" name="disconnect-button-twitter" value="Disconnect" class="text-danger">
        </form>
      </div>
    </div>
  </div>

<!-- Edit Instagram Bio Menu -->
<div class="modal fade" id="edit-bio-instagram-menu" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit Bio</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" id="edit-bio-form">
          New Bio:
          <p><textarea id="new-bio-instagram" name="new-bio" rows="4" cols="40"></textarea></p>
          <p><input type="submit" name="submit-instagram" class="btn btn-success btn-primary text-right" id="bio-change-submit-instagram" value="Submit"></p>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Edit Twitter Bio Menu -->
<div class="modal fade" id="edit-bio-twitter-menu" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit Bio</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" id="edit-bio-form">
          New Bio:
          <p><textarea id="new-bio-twitter" name="new-bio" rows="4" cols="40"></textarea></p>
          <p><input type="submit" name="submit-instagram" class="btn btn-success btn-primary text-right" id="bio-change-submit-twitter" value="Submit"></p>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Opperation modal -->
<div class="modal fade" id="opperation-post" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Create Opperation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <form method="post" id="opperation-post-form">
          <p>Opperation:
            <select id="select-opperation-type" onchange="opperationOptionChange(null, null, this)">
              <option value="post-on-social" selected>Post On Social Media</option>
              <option value="auto-like">Like Post On Social Media</option>
              <option value="auto-follow">Follow Users On Social Media</option>
            </select>
          </p>
          <div id="opperation-post-javascript"></div>
          <div id="choose-social-media-post-opperation"></div>
          <input type="submit" name="submit-instagram" class="btn btn-success btn-primary text-right" id="show-content-instagram" value="Submit" />
        </form>
        <p id="opperation-failed" class="text-danger"><span id="opperation-success" class="text-success"></span></p>
      </div>
    </div>
  </div>
</div>
<!-- Opperation History popup -->
<div class="modal fade" id="view-opperation-history" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">View Past Opperations</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body" id="opperation-history-body">
          <div id="view-all-opperations"></div>
          <br>
          <a href="#" style="position: absolute; bottom:1px; right:3%; float:right; color:#000"><p id="clear-opperation-history">Clear History</p></a>
        </div>
      </div>
    </div>
  </div>
  <!--Option Menu Instagram -->
  <div class="modal fade" id="account-options-menu-instagram" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="float-right">&times;</span>
          </button>

        <div class="modal-body" id="optionInstagramBody">
          <h6>Options</h6>
          <p>Set Auto Refresh Frequency</p>

        </div>
      </div>
    </div>
  </div>
  <!--Option Menu Twitter -->
  <div class="modal fade" id="account-options-menu-twitter" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="float-right">&times;</span>
          </button>

        <div class="modal-body" id="optionTwitterBody">
          <h6>Options</h6>
          <p>Set Auto Refresh Frequency</p>
        </div>
      </div>
    </div>
  </div>
  <!-- Using Jquery and JavaScript to have page function -->
<script>
        
        // Instagram Variables
        var instagramUsername = "{{ session['instagramUsername'] }}";

        var instagramBio = "{{ session['instagramBio'] }}";
    
        var instagramNumberOfFollowers = "{{ session['instagramNumberOfFollowers'] }}";

        var instagramNumberOfFollowing = "{{ session['instagramNumberOfFollowing'] }}";

        var instagramNumberOfPost = "{{ session['instagramNumberOfPost'] }}";
        
        var instagramOnDesktop = "{{ session['instagramOnDesktop'] }}";

        var instagramOnMobile = "{{ session['instagramOnMobile'] }}";

        var instagramOnWeb = "{{ session['instagramOnWeb'] }}";

        var instagramItems = [instagramUsername, instagramBio, instagramNumberOfFollowers, instagramNumberOfFollowing, instagramNumberOfPost, instagramOnDesktop, instagramOnMobile, instagramOnWeb]

        
        // Twitter Variables
        var twitterUsername = "{{ session['instagramUsername'] }}";

        var twitterBio = "{{ session['instagramBio'] }}";
    
        var twitterNumberOfFollowers = "{{ session['instagramNumberOfFollowers'] }}";

        var twitterNumberOfFollowing = "{{ session['instagramNumberOfFollowing'] }}";

        var twitterNumberOfPost = "{{ session['instagramNumberOfPost'] }}";
        
        var twitterOnDesktop = "{{ session['instagramOnDesktop'] }}";

        var twitterOnMobile = "{{ session['instagramOnMobile'] }}";

        var twitterOnWeb = "{{ session['instagramOnWeb'] }}";
        
        var twitterItems = [twitterUsername, twitterBio, twitterNumberOfFollowers, twitterNumberOfFollowing, twitterNumberOfPost, twitterOnDesktop, twitterOnMobile, twitterOnWeb]

        if(instagramItems[0] == 'none' && instagramItems[1] == 0 && instagramItems[2] == 0 && instagramItems[3] == 0 && instagramItems[4] == 0 && instagramItems[5] == 'False' && instagramItems[6] == 'False' && instagramItems[7] == 'False'){
            console.log('empty instagram account');
        } else {
            console.log('instagram account not empty')
        }
        $('#total-followers').html("Total Audience: " + instagramItems[2]) ;
        $('#total-post').html("Total Post: " + instagramItems[4]);
        $('#total-following').html("You're following " + instagramItems[3] + " people");

        // Connect Account Div
        function accountDiv(){
            var dashboardRow = document.getElementById('connect-account-div');

            var createrDiv = document.createElement('div');
            createrDiv.className = "col-sm-16";
            createrDiv.setAttribute('id', "holder-1");

            dashboardRow.appendChild(createrDiv);
            $('#holder-1').html('<div class="card" id="holder-2"><p><a href="#" style="color:#000" data-toggle="modal" data-target="#connect">Add An Account</a></p></div>');
        }
        accountDiv();

        // Add Acount Function 
        $('#select-account-type').on('change', function() {
          if(this.value == 'twitter'){
            parentDiv = document.getElementById('posting-form')
            var createrDiv = document.createElement('a');
            createrDiv.setAttribute('id', "sign-in-button");
            createrDiv.setAttribute('href', "{{ url_for('api.twitterLogin') }}");
            parentDiv.appendChild(createrDiv);
            $('#sign-in-button').html("<img src='{{ url_for('static', filename = 'img/dashboard/sign-in.png') }}'></img>");
          } else if (this.value == 'instagram'){
            parentDiv = document.getElementById('select-account-type');
          }
        });

        // Ajax Twitter Sign In

        // Conducting function On Click
        // $( "#sign-in-button" ).click(function() {
        //   $.ajax({
        //     type : 'POST',
        //     url : '/sign-in-twitter',
        //     success: function (value) {
        //       // var evalue = JSON.parse(value);
              
        //       alert(value);
        //     }
        //   });
        //   event.preventDefault();
        // });

        // Create Opperation Div
        function createOpperationDiv(){
            var dashboardRow = document.getElementById('create-opperation-div');

            var createrDiv = document.createElement('div');
            createrDiv.className = "col-sm-16";
            createrDiv.setAttribute('id', "holder-5");

            dashboardRow.appendChild(createrDiv);
            $('#holder-5').html('<div class="card" id="holder-6"><p><a href="#" id="connect-opperation" data-toggle="modal" data-target="#opperation-post" style="color:#000">Create New Opperation</a></p></div>');
        }
        createOpperationDiv();

        // Opperation Div
        function opperationDiv(){
            var dashboardRow = document.getElementById('opperations');

            var createrDiv = document.createElement('div');
            createrDiv.className = "col-sm-16";
            createrDiv.setAttribute('id', "holder-3");

            dashboardRow.appendChild(createrDiv);
            $('#holder-3').html('<div class="card" id="holder-4"><h5>Opperations</h5><div class="card" style=" height:17vh; display:inline-block;"id="opperationHistory">History: <table id="opperation-history-table" class="table"><tr><th style="width:33%;" scope="col">Type</th><th style="width:33%" scope="col">Likes/Follows</th><th style="width:33%" scope="col">Text/Hashtags</th><th style="width:33%;" scope="col">Location</th></tr></table></div><a href="#" style="color:#000" data-toggle="modal" data-target="#view-opperation-history"><p style="position: absolute; bottom:-20px; right:3%; float:right;">View All</p></a></div>');

            var getTableDiv = document.getElementById('view-all-opperations');
            var createrTable = document.createElement('table');
            createrTable.setAttribute('id', "view-all-opperations-table");
            getTableDiv.appendChild(createrTable);
            $('#view-all-opperations-table').html('<tr><th style="width:50%;" scope="col">Type</th><th style="width:50%" scope="col">Likes/Follows</th><th style="width:50%" scope="col">Text/Hashtags</th><th style="width:50%;" scope="col">Location</th><th style="width:50%;" scope="col">Date</th></tr>');

        }
        opperationDiv();
        
        $(document).ready(function(){
          var dashboardRow = document.getElementById('search-form-div');

          var createrDiv = document.createElement('div');
          createrDiv.className = "col-sm-16";
          createrDiv.setAttribute('id', "search-form-card-div");
          dashboardRow.appendChild(createrDiv)
          $('#search-form-card-div').html('<div class="card" id="holder-9"><h5>Search Engine Results</h5> <span class="ml-auto" style="">what is this</span></div>');
        });

        // Search Form
        $(document).ready(function(){

          // Conducting function On Submit
          $('#search-form').on('submit', function(event){
            $.ajax({
              type : 'POST',
              url : '/search-form',
              data : {
                search : $('#search-form-text').val()
              },
              success: function (value) {
                // var evalue = JSON.parse(value);
                
                alert(value.allItems);
              }
            });
            event.preventDefault();
          });
        });


    </script>
{% endblock %}